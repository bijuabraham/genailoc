# GenAI LOC Tracker

A Visual Studio Code extension that tracks lines of code (LOC) added during development and logs details about their source (handwritten, AI-generated, etc.) to a CSV file. This tool helps teams and researchers analyze coding patterns and measure the impact of AI coding assistants on development workflows.

![Version](https://img.shields.io/badge/version-0.1.0-blue)
![VS Code](https://img.shields.io/badge/VS%20Code-%5E1.60.0-brightgreen)

## Features

- Automatically tracks lines of code added in real-time
- Detects the source of code (handwritten, GitHub Copilot, Codeium, Cline/Claude, Tabnine, Aider, etc.)
- Logs data to a CSV file with:
  - Timestamp
  - User ID (system username)
  - File path
  - Number of lines added
  - Source of the code
- Customizable detection parameters for different AI coding assistants
- Priority-based detection with Cline/Claude checked first

## How It Works

The extension monitors text document changes in VS Code and:

1. Counts the number of lines added in each change
2. Detects if the code was generated by an AI tool by:
   - Checking which AI coding extensions are active
   - Using specialized detection functions for each AI tool with customized thresholds:
     - Line count threshold: Detects when a large number of lines are inserted at once
     - Character count threshold: Detects when a large number of characters are inserted at once
     - Timing threshold: Detects when changes occur shortly after a large insertion
   - Special handling for Cline/Claude with longer timing thresholds:
     - Uses a higher timing threshold (6000ms) to better detect Cline/Claude-generated code
     - Prioritizes Cline/Claude detection before other AI tools
3. Logs the information to a CSV file with timestamp, user ID, file path, lines added, and source

## Installation

### From VSIX File

1. Download the `.vsix` file from the releases
2. In VS Code, go to Extensions view (Ctrl+Shift+X)
3. Click the "..." menu in the top-right of the Extensions view
4. Select "Install from VSIX..." and choose the downloaded file

### From Source

1. Clone this repository
2. Run `npm install` to install dependencies
3. Run `npm run compile` to build the extension
4. Press F5 to start debugging (launches a new VS Code window with the extension active)

## Configuration

Configure the extension through VS Code settings:

- `genailoc.enabled`: Enable/disable LOC tracking (default: true)
- `genailoc.logFilePath`: Custom path for the log file (default: extension storage path)
- `genailoc.excludedFileTypes`: File patterns to exclude from tracking (default: [".git", "node_modules", ".vscode"])

## Log File Format

The extension creates a CSV file with the following columns:

```
timestamp,user_id,file_path,lines_added,source,actual_lines_added,actual_chars_added,actual_timing_since_last_insert,time_difference_since_previous,reason
```

Example:
```
2023-05-15T14:30:45.123Z,john_doe,/path/to/file.js,5,github copilot,12,120,1500,N/A,1
2023-05-15T14:35:12.456Z,john_doe,/path/to/another.js,10,handwritten,3,45,5000,3500,1
2023-05-15T14:40:22.789Z,john_doe,/path/to/third.js,8,cline,9,95,800,4200,1
```

The columns provide valuable information for analysis:

### Column Descriptions
- `timestamp`: The date and time when the code was added (ISO format)
- `user_id`: The system username of the developer
- `file_path`: The path to the file that was modified
- `lines_added`: The number of lines added in the change
- `source`: The detected source of the code (handwritten, github copilot, cline, codeium, tabnine, aider)
- `actual_lines_added`: The actual number of lines added in the change
- `actual_chars_added`: The actual number of characters added in the change
- `actual_timing_since_last_insert`: The actual time elapsed since the last large insertion (milliseconds)
- `time_difference_since_previous`: The time difference between the current and previous timing (milliseconds)
- `reason`: The reason code for the change (1 = Edits, 2 = Undo, 3 = Redo, 4 = Paste)

These values can help you analyze and fine-tune the detection parameters for different AI tools by comparing the threshold values with the actual detected values. This allows for more accurate analysis of detection accuracy and can help identify patterns in AI-generated code.

## Usage

After installation, the extension automatically starts tracking lines of code added to your project. No additional setup is required.

To view or analyze the collected data:
1. Find the CSV log file (in the extension storage path or your custom configured path)
2. Open the CSV file with your preferred spreadsheet application or data analysis tool
3. Use the data to gain insights into your coding patterns and the impact of AI tools on your workflow

## Privacy

The extension collects and stores data locally on your machine. No data is sent to external servers. The extension does not collect or store any personally identifiable information beyond what is necessary for tracking LOC.

## Detection Methods and Parameters

The extension uses specialized detection functions for each AI tool, allowing for customized threshold parameters for each.

### Detection Methods

1. **Insertion Size Detection**:
   - Checks if the number of lines or characters inserted exceeds thresholds
   - Used for all AI tools with customized thresholds
   - Triggered when either line count or character count thresholds are exceeded

2. **Timing-Related Detection**:
   - Checks if a change happened shortly after a large insertion
   - Used for all AI tools with customized thresholds
   - Helps detect follow-up changes that are part of the same AI suggestion

### Detection Parameters by AI Tool

| AI Tool | Lines Threshold | Characters Threshold | Timing Threshold |
|---------|----------------|---------------------|-----------------|
| GitHub Copilot | 1 line | 50 characters | 1000ms |
| Cline/Claude | 2 lines | 80 characters | 6000ms |
| Codeium | 12 lines | 120 characters | 1200ms |
| Tabnine | 8 lines | 80 characters | 800ms |
| Aider | 3 lines | 150 characters | 6000ms |

### Detection Functions

The extension implements separate detection functions for each AI tool:

```typescript
function detectCopilot(event: vscode.TextDocumentChangeEvent, activeExtensions: string[]): boolean
function detectCline(event: vscode.TextDocumentChangeEvent, activeExtensions: string[]): boolean
function detectCodeium(event: vscode.TextDocumentChangeEvent, activeExtensions: string[]): boolean
function detectTabnine(event: vscode.TextDocumentChangeEvent, activeExtensions: string[]): boolean
function detectAider(event: vscode.TextDocumentChangeEvent, activeExtensions: string[]): boolean
```

Each function checks:
1. If the corresponding extension is active
2. If the text change exceeds the tool-specific thresholds
3. If the change is timing-related to a previous large insertion

The main `detectSource` function calls these specialized functions in order of priority, with Cline/Claude checked first, followed by GitHub Copilot, Codeium, Tabnine, and Aider.

## Limitations

- Currently only tracks lines added to files, not modifications or deletions
- Source detection is based on configurable parameters and may not always be 100% accurate
- Detection accuracy depends on the threshold values and may require adjustment for different coding styles
- Different AI tools may have different detection characteristics, requiring customized thresholds
- Some AI tools may update their extension IDs or command patterns, requiring updates to the detection logic

## License

MIT

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

### Development Tips

- Run `npm run compile` to build the extension
- Use `npm run lint` to check for code style issues
- Test your changes with different AI coding assistants to ensure detection works correctly

## Reporting Issues

If you encounter any bugs or have feature requests, please open an issue on the GitHub repository or contact the extension author through the VS Code Marketplace.
